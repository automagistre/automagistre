doctrine:
    dbal:
        types:
            phone_number: \Misd\PhoneNumberBundle\Doctrine\DBAL\Types\PhoneNumberType
            uuid:  Ramsey\Uuid\Doctrine\UuidType
        connections:
            default:
                charset:  UTF8
                server_version: 12.2
                driver:   pdo_pgsql
                host:     db
                port:     5432
                dbname:   db
                user:     db
                password: "%env(DATABASE_PASSWORD)%"
                schema_filter: ~^(?!.*_view$).*~

    orm:
        auto_generate_proxy_classes: "%kernel.debug%"
        entity_managers:
            default:
                naming_strategy: App\Shared\Doctrine\ORM\Mapping\NamespaceNamingStrategy
                auto_mapping: false
                metadata_cache_driver:
                    type: pool
                    pool: doctrine.metadata_cache.pool
                mappings:
                    cron:
                        type: annotation
                        prefix: Cron\CronBundle\Entity
                        dir: '%kernel.project_dir%/vendor/cron/cron-bundle/Entity'
                        is_bundle: false
                    moneyphp:
                        type: xml
                        prefix: Money
                        dir: '%kernel.project_dir%/config/orm/money'
                        is_bundle: false
                    embeddable:
                        type: annotation
                        prefix: App\Entity\Embeddable
                        dir: '%kernel.project_dir%/src/Entity/Embeddable'
                        is_bundle: false
                    superclass:
                        type: annotation
                        prefix: App\Entity\Superclass
                        dir: '%kernel.project_dir%/src/Entity/Superclass'
                        is_bundle: false

doctrine_migrations:
    namespace: App\Migrations
    dir_name: '%kernel.project_dir%/src/Migrations'

framework:
    cache:
        pools:
            doctrine.metadata_cache.pool:
                adapter: cache.adapter.array

parameters:
    env(DATABASE_PASSWORD): '%env(default:default_db_password:trim:file:DATABASE_PASSWORD_FILE)%'
    env(DATABASE_PASSWORD_FILE): /run/secrets/database_password
    default_db_password: db

services:
    Doctrine\ORM\Mapping\NamingStrategy:
        alias: App\Shared\Doctrine\ORM\Mapping\NamespaceNamingStrategy
