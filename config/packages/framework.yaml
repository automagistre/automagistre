framework:
    #esi:             ~
    secret:          "%env(APP_SECRET)%"
    form:            ~
    csrf_protection: ~
    serializer:
        enable_annotations: true
    trusted_hosts:   ~
    session:
        enabled: true
        handler_id: Symfony\Component\HttpFoundation\Session\Storage\Handler\MigratingSessionHandler
        cookie_httponly: true
        cookie_secure: 'auto'
        cookie_samesite: 'lax'
    fragments:       ~
    http_method_override: true
    assets: ~
    php_errors:
        log: '%kernel.debug%'
    router:
        strict_requirements: false

services:
    Symfony\Component\PropertyAccess\PropertyAccessorInterface:
        alias: property_accessor

    Symfony\Component\HttpKernel\Controller\ArgumentResolverInterface:
        alias: argument_resolver

    session.memcached:
        class: Memcached
        public: true
        calls:
            - [ addServer, [ '%env(SESSION_MEMCACHED_HOST)%', '%env(SESSION_MEMCACHED_PORT)%' ]]
    session.handler.memcached:
        class:     Symfony\Component\HttpFoundation\Session\Storage\Handler\MemcachedSessionHandler
        arguments: [ '@session.memcached' ]
    Symfony\Component\HttpFoundation\Session\Storage\Handler\MigratingSessionHandler:
        arguments: [ '@session.handler.memcached', '@Symfony\Component\HttpFoundation\Session\Storage\Handler\RedisSessionHandler' ]

    Redis:
        class: Redis
        lazy: true
        calls:
            - [ connect, [ '%env(SESSION_REDIS_HOST)%', '%env(int:SESSION_REDIS_PORT)%' ]]
    Symfony\Component\HttpFoundation\Session\Storage\Handler\RedisSessionHandler:
        class:
        arguments: [ '@Redis' ]

parameters:
    locale: ru
    env(SESSION_MEMCACHED_HOST): 'memcached'
    env(SESSION_MEMCACHED_PORT): '11211'

    env(SESSION_REDIS_HOST): 'redis'
    env(SESSION_REDIS_PORT): '6379'
